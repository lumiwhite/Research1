\documentclass[a4paper,11pt,dvipdfmx]{jsarticle}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{bm}
\usepackage{mathtools}
\usepackage{comment}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{bm}
\usepackage{mathtools}
\usepackage{enumitem}
\mathtoolsset{showonlyrefs}
\usepackage[dvipdfmx, colorlinks=true, linkcolor=blue, citecolor=blue, urlcolor=blue, setpagesize=false]{hyperref}
\usepackage{pxjahyper}
% --- 定理・定義環境 ---
\theoremstyle{definition}
\newtheorem{definition}{定義}[section]
\newtheorem{theorem}[definition]{定理}
\newtheorem{lemma}[definition]{補題}
\newtheorem{assumption}{仮定}
\newtheorem{proposition}[definition]{命題}
\newtheorem{requirement}[definition]{要請}
\newtheorem{example}[definition]{例}
\input{command.tex}
% =========================================
\begin{document}

\title{Breaking the Orthogonality Barrier in Quantum LDPC Codes}
\author{}
\date{\today}
\maketitle
\tableofcontents

\section{概要}
古典的な低密度パリティ検査（LDPC）符号は、現代の通信およびストレージシステムの基盤を形成する、広く普及し確立された技術である。この古典的な設定において、正則な次数分布を維持しつつタナーグラフのガース（girth）を大きくすることが、良好な信念伝搬（BP）復号性能と大きな最小距離の両立につながることはよく知られている。しかし、量子設定においては、量子LDPC符号がそのパリティ検査行列間に付加的な直交性制約を満たさなければならないため、この原理を直接適用することはできない。直交性と正則性の両方を単純な手法で強制すると、通常はガースが減少し、最小距離が構造的に上界（アッパーバウンド）に制限されてしまう。

本研究では、正則な検査行列構造を維持しつつ、交換性が制御された置換行列を用い、かつ構成における必要な部分にのみ直交性制約を限定することで、この制限を克服する。この設計は、直交性、正則性、ガース、および最小距離の間の従来のトレードオフを打破し、大きなガースを持ち、かつ従来の距離上界に縛られない量子LDPC符号の構成を可能にする。具体的な実証として、ガース8、(3,12)正則な [[9216, 4612, $\le$ 48]] 量子LDPC符号を構成した。この符号は、BP復号と低計算量の後処理アルゴリズムを組み合わせることで、誤り確率4\%の脱分極チャネルにおいて、$10^{-8}$ という極めて低いフレーム誤り率（FER）を達成することを示す。

\section{はじめに}

古典的な低密度パリティ検査（LDPC）符号は、現代の通信およびストレージシステムにおいて広く展開されている確立された技術であり、信念伝搬（BP）復号によって通信路容量を達成できる。その性能はタナーグラフの次数分布に強く依存する。正則符号は良好な性能を示し、慎重に設計された非正則分布はBP性能をさらに向上させることができるが、不用意な非正則化は性能を劣化させる。変数ノードの次数が3以上のランダムLDPC符号は、ブロック長に対して線形に増大する最小距離を持つため、古典LDPCの研究では最小距離自体の増大には焦点が当てられてこなかった。さらに、BP復号はトラッピングセットと呼ばれるタナーグラフ内の小さな構造に捕らわれることがあり、これが復号失敗の原因となる。有害なトラッピングセットを抑制するには、通常、大きなガース（girth：グラフ内の最小閉路長）が必要とされる。

希薄グラフ量子誤り訂正符号（QLDPC符号）は2004年に提案され、反復復号の振る舞いや縮退の役割が議論されてきた。正の符号率と距離 $\Theta(\sqrt{n})$ を持つ符号族も知られている。クロネッカー和および積に基づく構成、一般化バイシクル（GB）符号の距離下界、有限長評価、および復号プロトコルが報告されており、CSS型QLDPC符号の理論的理解が進んでいる。しかし、CSSパリティ検査行列 $H_X$ と $H_Z$ の間の直交性条件、すなわち $H_X H_Z^T = 0$ は古典符号には存在しない制約である。直交性と正則性の両方を単純な手法で強制しようとすると、通常はガースが減少し、構造的な距離の上界が誘発される。

表面符号やハイパーグラフ積（HGP）符号は幾何学的構造や積構造に依存しているため、古典LDPC符号で開発された設計原理とは異なる原理に従っている。その結果、古典的な次数分布やガース設計技術を直接適用することは容易ではない。本研究の目的は、古典LDPCのパリティ検査構造を維持しつつ、それらをCSS検査行列として直接利用可能にする構成原理を提供することである。具体的には、大きなガースと3以上の変数次数を持ち、最小距離が自明な上界に制限されない正則LDPC符号を目指す。

先行研究では、正則タナーグラフの次数分布を明示的に制御できる巡回パリティ検査行列が探索されてきた。代表的な構成には、萩原・今井符号やバイシクル構成がある。しかし、これらの構成には既知の限界がある。古典符号であっても、プロトグラフの一段階リフティング（巡回置換行列（CPM）によるリフティング）は、プロトグラフの構造に起因してガースに固定の上界を課すことがある。一段階リフティングが最小距離とガースに固定の制限を課すこと、および二段階リフティングがそれらを改善できることが指摘されている。CSS符号の場合、パリティ検査行列 $H_X$ と $H_Z$ は準巡回（QC）であり、タナーグラフのガースは $g = \min\{g(H_X), g(H_Z)\}$ を満たすため、各行列にQCガースの上界が適用される。一般的な量子CPM-LDPC符号では、ガースは列重み2で12以下、列重み3以上で6以下に制限される。代数的置換行列（APM）LDPC符号を用いることで、これらの上界を打破することが可能である。

CSS型LDPCの構成において、パリティ検査行列 $H_X$ または $H_Z$ から行を削除しても交換条件 $H_X H_Z^T = 0$ は維持されるが、スタビライザー制約が弱まり、符号空間が拡大する可能性がある。行削除は符号率の調整や行・列重みの制御に用いられるが、一般に距離の保持は保証されない。特に行削除は、低重みのベクトルが $C_X \setminus C_Z^\perp$ または $C_Z \setminus C_X^\perp$ に入ることを許し、新たな低重みの論理演算子を生成して最小距離を減少させることがある。CSS符号において、$C_X = \text{ker}(H_X)$ および $C_Z = \text{ker}(H_Z)$ とすると、$C_X \setminus C_Z^\perp$ または $C_Z \setminus C_X^\perp$ 内の低重みベクトルは非自明な論理演算子となる。その結果、削除された検査行が論理演算子となり、距離を行重みで上界付ける可能性がある。

本研究では、まず、行削除がCSS符号の最小距離を劣化させる一般的なメカニズムについて議論する。次に、一般化萩原・今井符号に対して、行削除による距離劣化を避けるために部分行列の交換性を制御する符号設計手法を確立する。具体的には、APM-LDPC符号の代数的構造を用いて、アクティブな部分のみで直交性を保証し、交換が必要な行ペアの集合を導入して交換条件を局所化する。さらに、相互作用行列の非ゼロパターンを制御することで、削除された行が低重みの論理演算子として出現しないようにし、APM合成規則に基づく逐次構成アルゴリズムを提示する。具体的な実証として、(3,12)正則な $[[9216, 4612, \le 48]]$ 量子LDPC符号を構成し、低計算量の後処理アルゴリズムを組み合わせたBP復号の下で、誤り率4の脱分極チャネルにおいて $10^{-8}$ という低いフレーム誤り率（FER）を達成することを示す。また、交換制御の有無による構成を比較し、低重み論理演算子の抑制を実証する。

\section*{2 問題設定：検査行の削除によって誘発される低重み論理演算子}
本論文で用いる従来のCSS-LDPC符号の構成をまとめる。
互いに直交な2つの母正方(巡回)行列$\HHX,\HHZ$を構成する。
これらの母行列により定義されるCSS符号は一般的にレートが0であるため、内部の行を削除し、残った行を$\HX,\HZ$をアクティブ行列として用いることでレートを調整する。
つまり、
\begin{align}
  \HHX = \begin{bmatrix}
    \HX \\ \tilde{H}_X
  \end{bmatrix},
  \HHZ = \begin{bmatrix}
    \HZ \\ \tilde{H}_Z
  \end{bmatrix}
\end{align}
であり、$\HX,\HZ$がアクティブ行列、$\tilde{H}_X,\tilde{H}_Z$が潜在行列である。

しかしながら、この構成では、母行列の直交性は潜在行に制約を課し、最小距離を劣化させる。
最小距離は
\begin{align}
  d_Z := \min({wt{\bm{z}}:\bm{z}\in C_X\backslash C_Z^\perp}),\quad
  d_X := \min({wt{\bm{x}}:\bm{x}\in C_Z\backslash C_X^\perp})
\end{align}
により$d_{\text{min}}=\min({d_X,d_Z})$で定義される。
母行列の直交性
\begin{align}
  \HHX(\HHZ)^\top = 0
\end{align}
は、アクティブ行列$\HX,\HZ$間の直交性、つまり$\HX\HZ^\top = 0$だけでなく、以下も強制する。
\begin{align}
  \HX(\tilde{H}_Z)^\top = 0, \quad
  \HZ(\tilde{H}_X)^\top = 0
\end{align}
つまり、$\Row(\tHX)\in C_Z$ および $\Row(\tHZ)\in C_X$ である。
したがって$\tHX$の各行$\bm{x}$は$\bm{x}\in C_Z$であり、$\tHZ$の各行$\bm{z}$は$\bm{z}\in C_X$である。
一般的には$\bm{x}$は$C_X^\top$に属する必要はなく、$\bm{z}$も$C_Z^\perp$に属する必要はなく、このときこれらは論理演算子となる。最小行重み(我々の構成では$L$)が$d_X$および$d_Z$の上界となる。

本研究では、母行列から行を削除することでアクティブ行列$\HX,\HZ$を得るが、潜在行列の低重み行が、$\HX,\HZ$と直交しないようにこれらを設計する。
つまり、低重みの$\bm{x}\in\Row(\tHX)$に対し$\HZ\bm{x}^\top \neq 0$を、$\bm{z}\in\Row(\tHZ)$に対し$\HX\bm{z}^\top \neq 0$を強制し、つまり$\Row(\tHX)\not\subset C_Z$および$\Row(\tHZ)\not\subset C_X$を強制する。
同じ議論は、個々の潜在行だけでなく、低重みの線形結合にも適用される。

したがって、潜在ベースの$X,Z$距離の上階を以下で定義する。
\begin{align}
  d_X^{\text{lat}} &:= \min\left\{\wt(\bm{x}):\bm{x}\in \Row(\tHX)\cap C_Z\backslash C_X^\perp\right\}\\
  &=\min\left\{\wt(\bm{x}):\bm{x}\in C_Z, \bm{x}=(\tHX)^\top\bm{u}\text{ for some }\bm{u}, \bm{x}\not\in C_X^\top\right\}\\
  d_Z^{\text{lat}} &:= \min\left\{\wt(\bm{z}):\bm{z}\in \Row(\tHZ)\cap C_X\backslash C_Z^\perp\right\} \\
  &=\min\left\{\wt(\bm{z}):\bm{z}\in C_X, \bm{z}=(\tHZ)^\top\bm{u}\text{ for some }\bm{u}, \bm{z}\not\in C_Z^\top\right\}\\
\end{align}
提案された設計は、これらの境界を可能な限り大きくすることを目的としている。[26]では、符号語に対応する二進部分行列を非二進体へ持ち上げることで、それらがもはや符号語を表さなくなるようにしている。これは非二進持ち上げによる潜在ベース境界の拡大と見なすことができる。
\section{行列の設計方法}
この章では、上記の問題設定に基づき、
\begin{align}
\HX\HZ^\top = 0,\quad\HX(\tHZ)^\top \neq 0, \quad\HZ(\tHX)^\top \neq 0 
\end{align}
かつ$\dxl,\dzl$が大きい、を満たすような潜在行列$\tHX,\tHZ$を構成することを目指す。
我々は一般化した萩原-今井符号、つまり巡回行列構造の母行列のペアとを定義し、アクティブ行列$\HX,\HZ$間の直交性$\HX\HZ^\top = 0$

列重み$J$、行重み$L$プロトグラフLDPC符号はサイズ$P$の$J\times L$置換行列からなるパリティ検査行列により定義される。
置換$f:[P]\rightarrow[P]$に対し、対応する$P\times P$の置換行列$F=P(f)$は$F_{x,y}=1\iff f(x)=f(y)$で定義される。
各行と列は丁度1つの1を持ち、したがってブロック構造がコンパクトであるため母行列は疎である。

我々は一般化された萩原・今井符号を、萩原・今井準巡回CSS符号のプロトグラフ一般化として紹介する。
サイズ$P$の置換行列$F_i,G_i(i\in[L_2])$に対し、サイズ$(L_2P)\times (LP)$の母行列$\HHX,\HHZ$を以下で定義する。
\begin{align}
  (\HHX)_{i,j} &= F_{j-i},\quad (\HHX)_{i,L_2+j}=G_{j-i},\\
  (\HHZ)_{i,j} &= G_{i-j}^\top,\quad (\HHZ)_{i,L_2+j}=F_{i-j}^\top,
\end{align}
すべての添え字は$\bmod{L_2}$で計算される。
全体を通して、$[L/2]$内のインデックスは$\bmod{L/2}$で計算され、つまり$[L/2]$を$\mathbb{Z}_{L/2}$と同一視する。
直交性の十分条件は以下で与えられる。
アクティブ行列$\HX,\HZ$は上の$J$ブロック行から構成される。
従来の設計は、$\HX,\HZ$と$\HHX,\HHZ$がいずれも直交するように$F_i,G_j$に可換性を課した。
我々の関心は、母行列の直交性を課さずにアクティブ行列の直交性$\HX\HZ^\top = 0$を満たすことである。

$\HHX$の各ブロック行は、左側は$(F_0,F_1,\dots,F_{L/2-1})$の巡回シフトであり、右側は$(G_0,G_1,\dots,G_{L/2-1})$の巡回シフトである。
したがってブロックは差分$(j-i)$のみに依存し、母行列の席も差分のみに依存する。
任意の$i,k\in[L_2]$に対して、$(i,k)$ブロックは
\begin{align}
  (\HHX(\HHZ)^\top)_{i,k} = \sum_{u=0}^{L_2-1}\left(F_uG_{k-u} + G_{k-u}F_u\right) =: \Psi_r
\end{align}
で与えられ、これは$r=(k-i)\mod L_2$のみに依存する。
$r\in[L/2]$に対し、すべての$u\in[L/2]$に対し$F_u$と$G_{r-u}$が可換ならば、$\Psi_r=0$である。

\subsection{アクティブ直交性の十分条件}
我々は、$H_XH_Z\top=0$の十分証券の便利な形を再び導く。
\begin{align}
  \Delta := \left\{(k-i)\mod L/2\mid 0\leq i,k\leq J-1\right\}\subseteq[L/2]
\end{align}
を定義する。
以下の定理はこれらの差分で制限される可換性がアクティブ直交性をどのように保証するかを明らかにする。
\begin{theorem}
  もし$F_u$と$G_{r-u}$がすべての$r\in\Delta,u\in[L/2]$に対し可換ならば、$\HX\HZ^\top=0$である。
\end{theorem}
\begin{proof}
  すべての$i,k\in[J]$に対し、$r=(k-i)\mod L/2\in \Delta$である。
  仮定より$\Psi_r=0$なので、すべての$i,k\in[J]$に対し$(\HHX(\HHZ)^\top)_{i,k}=\Psi_{(k-i)\mod L/2}=0$であり、$\HX\HZ^\top=0$である。
\end{proof}

\subsection{潜在部の非直交性の必要条件}
可換性が必要な$(F_i,G_j)$のインデックスペアを以下で定義する。
\begin{align}
  \Gamma := \bigcup_{r\in\Delta} \Gamma_r,\quad \Gamma_r := \{(i,j)\mid(i,j)=(u,r-u), u\in[L/2]\}
\end{align}
ここで、添え字は$\bmod L/2$で計算する。
ここで、$\Gamma_r$は$\Psi_r$に寄与するインデックスの集合であり、$r\neq s$に対し$\Gamma_r\hat\Gamma_s = \emptyset$である。

もし$J\geq L/2$であればレートは0なので、$J<L/2$を仮定する。
まず、基本的で実現可能な制約を述べる：十分なブロックなしでは、潜在部の非直交性は強制できない。
\begin{theorem}
  アクティブ部の直交性$\HX\HZ^\top=0$を仮定する、
  一般できなアクティブ部の選択(上$J$ブロック行)に対し、$\HX(\tHZ)^\top \neq 0$および$\HZ(\tHX)^\top \neq 0$を満たすために、$L\geq 4J$が必要である。
\end{theorem}
\begin{proof}
  $L<4J$を仮定する。このアクティブ部の選択に対して、$\Delta = [L/2]$である。
  アクティブ部の直交性$\HX\HZ^\top=0$はすべての$r\in\Delta$に対して$\Psi_r=0$を意味し、したがってすべての$r\in[L/2]$に対して$\Psi_r=0$を意味する。
  ゆえに、$\HHX(\HHZ)^\top$のすべてのブロックが消滅し、特にアクティブ部と潜在部の行の混合ブロックについて、$\HX(\tHZ)^\top=0$と$\HZ(\tHX)^\top=0$が成り立ち、前提と矛盾する。
\end{proof}
次に、潜在部の非直交性に対する最小の代数的障害を分離する。

\begin{theorem}
  $\HX(\tHZ)^\top \neq 0,\quad\HZ(\tHX)^\top \neq 0$を満たすために、$\Psi_r \neq 0$が成り立つ$r\in[L/2]\backslash\Delta$が存在する必要がある。
\end{theorem}
\begin{proof}
  すべての$r\in[L/2]\backslash\Delta$に対し$\Psi_r=0$を仮定する。
  任意の$i\in[L/2]\backslash[J]$と$k\in[J]$に対し、$r=(k-i)\mod L/2$が$\Delta$に含まれない。
  $\Psi_r=0$の仮定により、このようなすべての$i,k$に対し、$(\tHX(\tHZ)^\top)_{i,k}=\Psi_{(k-i)\mod L/2}=0$である。
  したがって、$\HX(\tHZ)^\top = 0$であり、同様に$\HZ(\tHX)^\top = 0$であり、矛盾する。
  すべてのペア$(i,j)\in[L/2]^2\backslash\Delta$が可換ならば、各部分$F_uG_{r-u}+G_{r-u}F_u$は$\mathbb{F}_2$上で消滅し、すべての$r\not\in \Delta$に対して$\Psi_r=0$である。
\end{proof}

\subsection{ガースの上界}
最後に、必要なすべての差分において可換性が成立する場合に適用される構造的制約を想起する。
\begin{theorem}
  $L$を偶数とし、$2\leq J\leq L/2$を仮定する。
  もしすべての$r\in\Delta$と$u\in[L/2]$に対し$F_u$と$G_{r-u}$が可換ならば、$\HX,\HZ$のターナーグラフはそれぞれ8-サイクルを有する。
\end{theorem}
\begin{proof}
  $J\geq 2$より、$0,1\in\Delta$である。
  また$L/2\geq 2$なので、$[L/2]$の中に$i\neq i'$が存在する。
  $r=0,s=1$および$j=r-i,j'=s-i$(インデックスは$\bmod L/2$)とする。
  定義より、$(i,j),(i,j')\in\Gamma_r\cup\Gamma_s$であり、同様に$(i',j),(i',j')\in\Gamma_r\cup\Gamma_s$である。
  対応する$F,G$の可換性の仮定より、2つのF列と2つのG列から構成される8サイクル語は以下である。
  \begin{align}
    W=F_{i}G_j\inv G_{j'}F_i\inv F_{i'}G_{j'}\inv G_jF_{i'}\inv\label{eq:01201453}
  \end{align}
  可換性を用いて並び替えると、$W=(F_iF_i\inv)(F_{i'}F_{i'}\inv)(G_jG_j\inv)(G_{j'}G_{j'}\inv)=I$となり、$\HX,\HZ$のタナーグラフには必ず8-サイクルが存在する。

\end{proof}

\section{行列構成の方法}
以前の章で導いた可換性条件とアクティブ部の直交性に基づき、短サイクルを回避しつつこれらの制約を満たす置換ブロックを構築する具体的な逐次手順を提示する。
与えられた$(L/2,P,J)$に対して、以下を同時に満たす$\{F_i\},\{G_i\}$を構築する。
\begin{enumerate}
  \item $f_i,G_j$は$(i,j)\in\Delta$に対して可換である
  \item 少なくとも一つの$(i,j)\in[L/2]^2\backslash\Delta$に対して非可換である
  \item アクティブ行列$\HX,\HZ$内の短いサイクルを避ける(長さ8以下のUTCBC以外のサイクル)
\end{enumerate}

循環置換行列（CPM）から準循環LDPCブロックを構築する枠組みは、Fossorierによって体系化された。
我々はアフィン置換行列（APM）を採用する：APM-LDPCの枠組みはCPMを拡張し、その代数的形態により合同条件を通じて可換性の制御が容易となる。
古典的な設定において、吉田と笠井は線形置換多項式（APMベース）符号がプロトグラフLDPC符号に匹敵する性能を達成すると報告した。
一方、ワンステップCPMリフティングとは異なり、APMベースの構成法については固定ガース上限が報告されていない。長さ及びガースを拡張するためにAPM-LDPC符号を組み合わせる手法も提案されている。
群論的観点から、整数体上のAPMはアフィン群$\text{AGL}(1, \mathbb{Z}_P) = \mathbb{Z}_P\rtimes \mathbb{Z}_P^\times $を形成する。
これは単位群による平行移動の半直積であり、可換性は線形部分と平行移動部分の相互作用によって規定される。

$\mathbb{Z}_P$上のアフィン置換を考える。
\begin{align}
  f(x) = ax+b,\quad a\in\mathbb{Z}_P^\times, b\in\mathbb{Z}_P
\end{align}
$f_i(x)=a_ix+b_i$および$g_j(x)=c_jx+d_j$とし、対応する置換行列を$F_i:=P(f_i),G_j:=P(g_j)$で表す。

この表現の下で、APの可換性は二次合同式によって検証される：
\begin{align}
  f_ig_j = g_jf_i\iff d_j(a_i-1) - b_i(c_j-1) \equiv 0 \mod P
\end{align}
この条件は$a_i, c_j$と$b_i, d_j$の積を含む。
したがって交換表は合同式系として表現可能であり、特に$a_i, c_j$を先に選択した場合、交換制約は$b_i, d_j$における線形合同式に還元され、一貫性のある探索を可能とする。

我々は、交換表と短サイクル条件の両方を満たす候補を順次選択し、候補が失敗した場合にはバックトラッキングを用いる。
試行回数は直近の成功率に基づいて動的に調整される。
各候補生成器を多腕バンディットの腕として解釈し、それに応じて試行を割り当てる。

短サイクル検出は、複合写像$\Sigma$の固定点をブロックサイクルパターンに沿って調べることに帰着する。
APの合成関数は再びAPであり、$\Sigma(x) = Ax + B$となるため、
\begin{align}
  \Sigma(x) = x\iff \gcd(A-1,P)\mid B
\end{align}
はタナーグラフを列挙せずにテストを提供する。
\section{復号方式}
\section{結果}
第3節の一般理論と第4節の逐次構築法を、構築可能な最小ケースである$J = 3, L = 12, P = 768$に対して具体化する。
まず明示的な$\Delta, \Gamma, \Psi_r$を与え、アクティブ行列$\HX,\HZ$のアクティブ直交条件を明確化した後、
交換表とAPMパラメータを設計し、最後に距離境界とFERを評価する。
\subsection{構造とアクティブ部の直交性}
$J=3, L/2=6$に対し、各ブロック行は前の行のサイクルシフトであり、$\HHX,\HHZ$は$6\times 12$のブロック巡回構造である：
\begin{align}
  \HHX &= \left( \begin{array}{cccccc|cccccc}
  F_0 & F_1 & F_2 & F_3 & F_4 & F_5 & G_0 & G_1 & G_2 & G_3 & G_4 & G_5 \\
  F_5 & F_0 & F_1 & F_2 & F_3 & F_4 & G_5 & G_0 & G_1 & G_2 & G_3 & G_4 \\
  F_4 & F_5 & F_0 & F_1 & F_2 & F_3 & G_4 & G_5 & G_0 & G_1 & G_2 & G_3 \\ \hline
  F_3 & F_4 & F_5 & F_0 & F_1 & F_2 & G_3 & G_4 & G_5 & G_0 & G_1 & G_2 \\
  F_2 & F_3 & F_4 & F_5 & F_0 & F_1 & G_2 & G_3 & G_4 & G_5 & G_0 & G_1 \\
  F_1 & F_2 & F_3 & F_4 & F_5 & F_0 & G_1 & G_2 & G_3 & G_4 & G_5 & G_0
  \end{array} \right).\\
  \HHZ &= \left( \begin{array}{cccccc|cccccc}
  G'_0 & G'_5 & G'_4 & G'_3 & G'_2 & G'_1 & F'_0 & F'_5 & F'_4 & F'_3 & F'_2 & F'_1 \\
  G'_1 & G'_0 & G'_5 & G'_4 & G'_3 & G'_2 & F'_1 & F'_0 & F'_5 & F'_4 & F'_3 & F'_2 \\
  G'_2 & G'_1 & G'_0 & G'_5 & G'_4 & G'_3 & F'_2 & F'_1 & F'_0 & F'_5 & F'_4 & F'_3 \\ \hline
  G'_3 & G'_2 & G'_1 & G'_0 & G'_5 & G'_4 & F'_3 & F'_2 & F'_1 & F'_0 & F'_5 & F'_4 \\
  G'_4 & G'_3 & G'_2 & G'_1 & G'_0 & G'_5 & F'_4 & F'_3 & F'_2 & F'_1 & F'_0 & F'_5 \\
  G'_5 & G'_4 & G'_3 & G'_2 & G'_1 & G'_0 & F'_5 & F'_4 & F'_3 & F'_2 & F'_1 & F'_0
  \end{array} \right).
\end{align}
ここで、単純のために、$A'$は$A$の転置を表す。
例えば、$\HHX(\HHZ)^\top$の(0,1)ブロックは
\begin{align}
  (\HHX(\HHZ)^\top)_{0,1} &= F_0G_1 + F_1G_0 + F_2G_5 + F_3G_4 + F_4G_3 + F_5G_2\\
  &\quad +G_0F_1 + G_1F_0 + G_2F_5 + G_3F_4 + G_4F_3 + G_5F_2\\
  &= \Psi_1
\end{align}
$\Delta=\{0,1,2,4,5\}$について、
\begin{align}
  \Gamma = \{(i,j)\in[L/2]^2\mid i+j\not\equiv 3(\bmod 6)\} = [L/2]^2\backslash\{(0,3),(1,2),(2,1),(3,0),(4,5),(5,4)\}
\end{align}
$J=3$におけるアクティブ行列$\HX,\HZ$に対して、
\begin{align}
  \HX\HZ^\top = (\Psi_{(k-i)\bmod 6})_{0\leq i,k\leq 2} = \begin{bmatrix}
    \Psi_0 & \Psi_1 & \Psi_2 \\
    \Psi_5 & \Psi_0 & \Psi_1 \\
    \Psi_4 & \Psi_5 & \Psi_0
  \end{bmatrix}
\end{align}
したがって、アクティブ部の直交性は以下と等価である。
\begin{align}
  \Psi_r = 0 \qquad(r\in\{0,1,2,3,4,5\}=\Delta)
\end{align}
よって$r=3$の相互性は自由に保たれる。
母行列の積$\HHX(\HHZ)^\top$は
\begin{align}
  \HHX(\HHZ)^\top = (\Psi_{(k-i)\bmod 6})_{0\leq i,k\leq 5} = \left(\begin{array}{ccc|ccc}
    \Psi_0 & \Psi_1 & \Psi_2 & \Psi_3 & \Psi_4 & \Psi_5 \\
    \Psi_5 & \Psi_0 & \Psi_1 & \Psi_2 & \Psi_3 & \Psi_4 \\
    \Psi_4 & \Psi_5 & \Psi_0 & \Psi_1 & \Psi_2 & \Psi_3 \\ \hline
    \Psi_3 & \Psi_4 & \Psi_5 & \Psi_0 & \Psi_1 & \Psi_2 \\
    \Psi_2 & \Psi_3 & \Psi_4 & \Psi_5 & \Psi_0 & \Psi_1 \\
    \Psi_1 & \Psi_2 & \Psi_3 & \Psi_4 & \Psi_5 & \Psi_0
  \end{array}\right)
\end{align}



\end{document}